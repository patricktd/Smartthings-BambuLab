# profiles/bambulab-printer.yml
name: bambulab.printer.profile.v3
components:
  - id: main
    capabilities:
      - id: switch
        version: 1
      - id: refresh
        version: 1
      - id: healthCheck
        version: 1
      # Capabilities Personalizadas:
      - id: bambuPrinterJobStatus.v1
        version: 1
      - id: patchprepare64330.bedTemperature # Não precisa de .v1 aqui se o ID no ficheiro da capability não o tiver
        version: 1
      - id: patchprepare64330.nozzleTemperature
        version: 1
      - id: patchprepare64330.printProgress
        version: 1
    categories:
      - name: Switch # Ou Other
preferences:
  - name: "ipAddress"
    title: "Endereço IP da Impressora"
    description: "Digite o endereço IP local da sua impressora Bambu Lab."
    required: true
    definition:
      type: "string"
      default: ""
  - name: "port"
    title: "Porta MQTT"
    description: "Porta para conexão MQTT (padrão 8883 para Bambu Lab)."
    required: true
    definition:
      type: "integer"
      default: 8883
      minimum: 1
      maximum: 65535
  - name: "username"
    title: "Utilizador MQTT"
    description: "Nome de utilizador para a conexão MQTT."
    required: true
    definition:
      type: "string"
      default: "bblp"
  - name: "accessToken"
    title: "Senha / Access Code MQTT"
    description: "A senha ou 'Access Code' fornecido pela impressora para MQTT."
    required: true
    definition:
      type: "string"
      stringType: "password"
      default: ""
  - name: "caCertificate"
    title: "Certificado CA (Formato PEM)"
    description: "Cole o conteúdo completo do certificado CA. Deve começar com '-----BEGIN CERTIFICATE-----'."
    required: true
    definition:
      type: "string"
      stringType: "paragraph"
      default: ""
  - name: "mqttSerial"
    title: "Número de Série da Impressora (para Tópicos)"
    description: "O número de série da impressora, usado para construir os tópicos MQTT (ex: N4P00P000000000)."
    required: true
    definition:
      type: "string"
      default: ""
  - name: "mqttClientId"
    title: "MQTT Client ID (Opcional)"
    description: "ID de cliente MQTT a ser usado. Deixe em branco para usar o ID do dispositivo SmartThings."
    required: false
    definition:
      type: "string"
      default: ""